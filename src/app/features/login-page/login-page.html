<main
  class="flex items-center justify-center min-h-screen relative overflow-hidden bg-gradient-to-tr from-azul-oscuro to-verde-turquesa">
  <i class="bi bi-cup-hot-fill text-[#5d4037] text-2xl absolute animate-float top-[10%] left-[10%] animate-delay-0"></i>
  <i
    class="bi bi-tree-fill text-[#5d4037] text-2xl absolute animate-float top-[20%] right-[15%] animate-delay-2000"></i>
  <i
    class="bi bi-seedling-fill text-[#5d4037] text-2xl absolute animate-float bottom-[30%] left-[8%] animate-delay-4000"></i>
  <i
    class="bi bi-leaf-fill text-[#5d4037] text-2xl absolute animate-float bottom-[15%] right-[20%] animate-delay-1000"></i>
  <i class="bi bi-sun-fill text-[#5d4037] text-2xl absolute animate-float top-[50%] left-[5%] animate-delay-3000"></i>
  <i
    class="bi bi-cloud-haze2-fill text-[#5d4037] text-2xl absolute animate-float top-[60%] right-[10%] animate-delay-5000"></i>

  @if(mensaje()){
  <div
    class="fixed top-4 left-1/2 -translate-x-1/2 max-w-sm w-full p-4 rounded-lg shadow-md bg-{{mensaje()?.type === 'success' ? 'green' : 'red'}}-500 text-white z-50 flex items-center justify-between">
    <span>{{mensaje()?.text}}</span>
    <button type="button" class="text-white hover:text-gray-200 transition-colors" (click)="mensaje.set(null)">
      <i class="bi bi-x-lg"></i>
    </button>
  </div>
  }

  <div class="container mx-auto px-4 z-10">
    <div class="flex flex-col items-center justify-center">
      <div
        class="w-full max-w-md login-card bg-white/90 p-8 md:p-10 backdrop-blur-lg rounded-[20px] shadow-[0_15px_35px_rgba(0,0,0,0.1)]">
        <div class="flex items-center justify-center gap-3 mb-6">
          <i class="bi bi-person-vcard brand-logo-text bg-gradient-to-tr from-[#003366] to-[#00b894] text-8xl"></i>
          <div>
            <h1
            class="text-3xl font-bold brand-logo-text p-2 bg-gradient-to-tr from-[#003366] to-[#00b894] text-amber-50 ">
            EcoAndes Café</h1>
          <p class="text-gray-500">Inicia sesión para acceder a tu cuenta.</p>
          </div>
        </div>

        <form [formGroup]="loginForm" (ngSubmit)="onSubmit()">
          <div class="mb-5">
            <label for="username" class="block text-gray-700 text-sm font-semibold mb-2">
              <i class="bi bi-person-circle text-blue-500 mr-2"></i>Usuario
            </label>
            <div class="flex rounded-md shadow-sm">
              <span
                class="inline-flex items-center px-4 rounded-l-md border border-r-0 border-gray-300 bg-gray-50 text-gray-500 text-sm">
                <i class="bi bi-person"></i>
              </span>
              <input type="text"
                [class]="'form-control flex-1 block w-full px-3 py-2 border rounded-r-md placeholder-gray-400 focus:outline-none focus:ring-2  ' + ( username?.valid ? 'border-green-600  focus:ring-green-500':'border-gray-300                 focus:ring-amber-800 ' )"
                id="username" formControlName="username" placeholder="Ingresa tu usuario" required autofocus />
            </div>
            @if(usernameError) {
            <div class="text-red-500 mt-1 text-sm">
              {{usernameError}}
            </div>
            }

            <div class="mb-5 mt-4">
              <label for="password" class="block text-gray-700 text-sm font-semibold mb-2">
                <i class="bi bi-shield-lock text-blue-500 mr-2"></i>Contraseña
              </label>
              <div class="flex rounded-md shadow-sm">
                <span
                  class="inline-flex items-center px-4 rounded-l-md border border-r-0 border-gray-300 bg-gray-50 text-gray-500 text-sm">
                  <i class="bi bi-lock"></i>
                </span>

                <input [type]="showPassword() ? 'text' : 'password'"
                  [class]="'block w-full px-3 py-2 border border-gray-300  placeholder-gray-400 focus:outline-none focus:ring-2  ' + ( password?.valid ? 'border-green-600  focus:ring-green-500':'border-gray-300                 focus:ring-amber-800 ' )"
                  id="password" formControlName="password" placeholder="Ingresa tu contraseña" required />

                <button type="button"
                  class="inline-flex items-center px-4 rounded-r-md border border-l-0 border-gray-300 bg-gray-50 text-gray-500 hover:bg-gray-200 transition-colors"
                  (click)="togglePasswordVisibility()" title="Mostrar/ocultar contraseña">
                  <i class="bi" [class]="showPassword() ? 'bi-eye-slash' : 'bi-eye'"></i>
                </button>
              </div>
              @if(passwordError) {
              <div class="text-red-500 mt-1 text-sm">
                {{passwordError}}
              </div>
              }
            </div>

            <div class="mb-6">
              <div class="flex items-center">
                <input class="form-checkbox h-4 w-4 text-blue-600 transition duration-150 ease-in-out" type="checkbox"
                  id="remember-me" formControlName="rememberMe" />
                <label class="ml-2 block text-sm text-gray-900" for="remember-me">
                  <i class="bi bi-bookmark-heart text-pink-500 mr-1"></i>
                  Recordar mi sesión
                </label>
              </div>
            </div>
            @if(this.authService.errorMessage()){
            <p class="py-3 text-red-500">{{this.authService.errorMessage()}}</p>
            }
            <div class="mb-6">
              <button type="submit"
                class="w-full flex justify-center py-3 px-4 btn-primary-gradient bg-gradient-to-tr from-[#003366] to-[#00b894] text-amber-50 hover:translate-y-[-2px] hover:shadow-[0_5px_15px_rgba(102,126,234,0.4)] rounded-full hover:font-semibold transition-all duration-300 ease-in-out disabled:opacity-50 disabled:cursor-not-allowed"
                [disabled]="!loginForm.valid">
                @if(authService.isLoading()){
                  <app-spiner-cargando mensaje="Iniciando Sesión" />
                }@else{
                  <i class="bi bi-box-arrow-in-right mr-2"></i> Iniciar Sesión
                }
              </button>
            </div>
          </div>
        </form>

        <div class="text-center">
          <div class="mb-3">
            <a href="/recuperar-password"
              class="text-blue-500 hover:text-blue-700 text-sm font-semibold transition-colors">
              <i class="bi bi-key mr-1"></i> ¿Olvidaste tu contraseña?
            </a>
          </div>
          <div class="mb-3">
            <p class="mb-2 text-gray-500 text-sm">¿No tienes cuenta?</p>
            <a routerLink="/register"
              class="inline-flex items-center px-4 py-2 border border-blue-500 rounded-md shadow-sm text-sm font-medium text-blue-500 hover:bg-blue-50 hover:text-blue-600 transition-colors">
              <i class="bi bi-person-plus mr-1"></i>
              Registrarse
            </a>
          </div>
        </div>
      </div>
    </div>
  </div>
</main>
